{"version":3,"sources":["log.js"],"names":["_bundleProgressBar","_printNewLineBeforeNextLog","_isLastLineNewLine","_updateIsLastLineNewLine","args","length","lastArg","match","_maybePrintNewLine","console","log","consoleLog","consoleWarn","warn","consoleError","error","respectProgressBars","commitLogs","terminate","lastDraw","render","getPrefix","chalkColor","gray","withPrefixAndTextColor","map","arg","withPrefix","config","raw","nested","message","newLine","addNewLineIfNone","printNewLineBeforeNextLog","setBundleProgressBar","bar","red","nestedError","yellow","nestedWarn","chalk"],"mappings":"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","file":"../log.js","sourcesContent":["import chalk from 'chalk';\n\nlet _bundleProgressBar;\n\nlet _printNewLineBeforeNextLog = false;\nlet _isLastLineNewLine = false;\nfunction _updateIsLastLineNewLine(args) {\n  if (args.length === 0) {\n    _isLastLineNewLine = true;\n  } else {\n    let lastArg = args[args.length - 1];\n    if (typeof lastArg === 'string' && (lastArg === '' || lastArg.match(/[\\r\\n]$/))) {\n      _isLastLineNewLine = true;\n    } else {\n      _isLastLineNewLine = false;\n    }\n  }\n}\n\nfunction _maybePrintNewLine() {\n  if (_printNewLineBeforeNextLog) {\n    _printNewLineBeforeNextLog = false;\n    console.log();\n  }\n}\n\nfunction consoleLog(...args) {\n  _maybePrintNewLine();\n  _updateIsLastLineNewLine(args);\n\n  console.log(...args);\n}\n\nfunction consoleWarn(...args) {\n  _maybePrintNewLine();\n  _updateIsLastLineNewLine(args);\n\n  console.warn(...args);\n}\n\nfunction consoleError(...args) {\n  _maybePrintNewLine();\n  _updateIsLastLineNewLine(args);\n\n  console.error(...args);\n}\n\nfunction respectProgressBars(commitLogs) {\n  if (_bundleProgressBar) {\n    _bundleProgressBar.terminate();\n    _bundleProgressBar.lastDraw = '';\n    commitLogs();\n    _bundleProgressBar.render();\n  } else {\n    commitLogs();\n  }\n}\n\nfunction getPrefix(chalkColor) {\n  return chalkColor('[') + chalk.gray('exp') + chalkColor(']');\n}\n\nfunction withPrefixAndTextColor(args, chalkColor = chalk.gray) {\n  return [getPrefix(chalkColor), ...args.map(arg => chalkColor(arg))];\n}\n\nfunction withPrefix(args, chalkColor = chalk.gray) {\n  return [getPrefix(chalkColor), ...args];\n}\n\nfunction log(...args) {\n  if (log.config.raw) {\n    return;\n  }\n\n  respectProgressBars(() => {\n    consoleLog(...withPrefix(args));\n  });\n}\n\nlog.nested = function(message) {\n  respectProgressBars(() => {\n    consoleLog(message);\n  });\n};\n\nlog.newLine = function newLine() {\n  respectProgressBars(() => {\n    consoleLog();\n  });\n};\n\nlog.addNewLineIfNone = function addNewLineIfNone() {\n  if (!_isLastLineNewLine && !_printNewLineBeforeNextLog) {\n    log.newLine();\n  }\n};\n\nlog.printNewLineBeforeNextLog = function printNewLineBeforeNextLog() {\n  _printNewLineBeforeNextLog = true;\n};\n\nlog.setBundleProgressBar = function setBundleProgressBar(bar) {\n  _bundleProgressBar = bar;\n};\n\nlog.error = function error(...args) {\n  if (log.config.raw) {\n    return;\n  }\n\n  respectProgressBars(() => {\n    consoleError(...withPrefixAndTextColor(args, chalk.red));\n  });\n};\n\nlog.nestedError = function(message) {\n  respectProgressBars(() => {\n    consoleError(chalk.red(message));\n  });\n};\n\nlog.warn = function warn(...args) {\n  if (log.config.raw) {\n    return;\n  }\n\n  respectProgressBars(() => {\n    consoleWarn(...withPrefixAndTextColor(args, chalk.yellow));\n  });\n};\n\nlog.nestedWarn = function(message) {\n  respectProgressBars(() => {\n    consoleWarn(chalk.yellow(message));\n  });\n};\n\nlog.gray = function(...args) {\n  if (log.config.raw) {\n    return;\n  }\n\n  respectProgressBars(() => {\n    consoleLog(...withPrefixAndTextColor(args));\n  });\n};\n\nlog.raw = function(...args) {\n  if (!log.config.raw) {\n    return;\n  }\n\n  respectProgressBars(() => {\n    consoleLog(...args);\n  });\n};\n\nlog.chalk = chalk;\n\nlog.config = {\n  raw: false,\n};\n\nexport default log;\n"],"sourceRoot":"/Users/ville/Projects/expo/universe/dev/exp/src"}